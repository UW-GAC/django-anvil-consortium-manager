# content of: tox.ini , put in same dir as setup.py
[tox]
envlist = py{38,39,310}-django{32,41,42}-{sqlite,mysql}
isolated_build = true
# We need 4.4.0 for constrain_package_deps.
min_version = 4.4.0

[testenv]
deps =
    django32: Django==3.2.*
    django40: Django==4.0.*
    django41: Django==4.1.*
    django42: Django==4.2.*
    responses
    factory-boy
    coverage
    django-coverage-plugin
    freezegun
    django-test-migrations
    mysql: mysqlclient==2.1.1
constrain_package_deps = true
passenv =
    DBNAME
    DBUSER
    DBPASSWORD
    DBHOST
    DBBACKEND
    DBPORT
commands =
    coverage run -p ./manage.py test anvil_consortium_manager --settings=anvil_consortium_manager.tests.settings.test

[testenv:py{38,39,310}-django{32,41,42}-mysql]
setenv =
    DBBACKEND = mysql

[testenv:py{38,39,310}-django{32,41,42}-sqlite]
setenv =
    DBBACKEND = sqlite3
    DBNAME = ":memory:"

[gh-actions]
python =
    3.8: py38
    3.9: py39
    3.10: py310

[gh-actions:env]
DBBACKEND =
    sqlite3: sqlite
    mysql: mysql
